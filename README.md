# hack_itmo
Данные взяты:
1. https://www.kaggle.com/datasets/blackmoon/russian-language-toxic-comments.
2. https://www.kaggle.com/datasets/nigula/russianinappropriatemessages?select=train.csv

По второму набору данных обрабатывали только проходит модерацию или нет (все остальные целевые признаки отбросили).

После скачивания репы нужно в ней же создать директории `data/russian_toxic` (для первого набора данных) и `data/russian_inappropriate_messages` - там должны быть размещены данные для обучения.

В данных есть перекос классов в связи с чем взята метрика `F1`.
Из чего состоит:
1. Предобработка текста(удаление лишних символов, стоп-слов, приведение к нормальной форме - pymorphy2)
2. Обучение с CatBoost(2500 эпох на GPU). `F1 = 84%` - для первого набора данных, `F1 = 74%` - для второго набора данных
3. API Flask которая так же применяет предобработку текста.

Запросы идут в json(пример):
```json
{
    "version": "1.0",
    "event_type": "toxic_or_not",
    "event_date": "2022-09-17T18:40:35+03:00",
    "comment":" увы увы это нужно придумать сверхъестественный сила это нужно минимум знать сила сверхъестественный вон африка верить сделать вышка пальма посадить человек наушник кокос несомненно прилететь великий дух сбросить небо парашют груз консервы белый это работать значит получиться сила характерный вполне реальный называться ввс сша отношение культ карго вполне мистический ритуализировать"
}
```
ответ так же приходит в json:
```json
{
    "body": {
        "answer": "not toxic",
        "probability": 0.985111599623384
    },
    "event_date": "2022-09-17T18:40:35+03:00",
    "event_type": "toxic_or_not",
    "version": "1.0"
}
```
где поле `answer` - ответ модели(токсичный/не токсичный текст) и `probability` - "степень уверенности" модели
